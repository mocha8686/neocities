---
import { getCollection } from 'astro:content';

import CryptopalsLayout from '$src/layouts/CryptopalsLayout.astro';

const sets = (await getCollection('cryptopals')).toSorted(
	(a, b) => a.data.number - b.data.number,
);
---

<CryptopalsLayout>
	<h1>cryptopals</h1>

	<p>
		These are my writeups for the
		<a href="https://cryptopals.com/">cryptopals crypto challenges</a>, written
		in
		<a href="https://rust-lang.org/">Rust</a>. I've redone these challenges over
		and over again since I didn't want to refactor the code, once in Rust and
		now twice in Zig.
	</p>

	<p>
		Originally, I posted solutions using Zig, but my first attempt fell to the
		whims of time, and when I went to pick it back up, Zig 0.15 released and
		much of my code became deprecated, so I elected to start over. Then, my
		second attempt with 0.15 was put to a halt due to mysterious segfaults when
		I tried to import a file, so at that point, I decided to take a break from
		Zig until it's reached its release.
	</p>

	<p>
		<a href="https://github.com/mocha8686/cryptopals/">The repository</a>
		is also available on GitHub.
	</p>

	<hr />

	<section class="sets">
		{
			sets.map(({ id, data: { title, number, description } }) => (
				<div class="set">
					<h2>
						{number}. {title}
					</h2>
					<p>{description}</p>
					<a href={`${id}/`}>Go</a>
				</div>
			))
		}
	</section>
</CryptopalsLayout>

<style>
	p {
		max-width: 60ch;
		line-height: 1.4;
		text-wrap: pretty;
	}

	.sets {
		--min-card-size: 14rem;

		display: grid;
		grid-auto-rows: auto 1fr auto;
		grid-template-columns: repeat(
			auto-fill,
			minmax(min(var(--min-card-size), 100%), 1fr)
		);
		gap: 1rem;
	}

	.set {
		--margin: 0.5rem;

		overflow: clip;
		display: grid;
		grid-row: span 3;
		grid-template-columns:
			[full-width-start]
			var(--margin)
			[content-start]
			1fr
			[content-end]
			var(--margin)
			[full-width-end];
		grid-template-rows: subgrid;
		gap: 1rem;

		padding-block-end: 0.75rem;
		border-radius: 1rem;

		color: var(--cl-on-container);

		background: var(--cl-container);
		box-shadow: 0 2px 6px -2px black;

		h2 {
			grid-column: full-width;

			margin: 0;
			padding-inline: 0.5em;

			color: var(--cl-on-accent-container);

			background: var(--cl-accent-container);
		}

		p {
			grid-column: content;
			margin: 0;
		}

		a {
			display: block;
			grid-column: content;
			text-align: end;

			&::after {
				content: ' Â»';
			}
		}
	}
</style>
